<!DOCTYPE html>

<html>
<head>
  <title>refine_test.go</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="core_binaryreconcile.html">
                core_binaryreconcile.go
              </a>
            
              
              <a class="source" href="core_genetree.html">
                core_genetree.go
              </a>
            
              
              <a class="source" href="core_node.html">
                core_node.go
              </a>
            
              
              <a class="source" href="core_rf.html">
                core_rf.go
              </a>
            
              
              <a class="source" href="core_speciestree.html">
                core_speciestree.go
              </a>
            
              
              <a class="source" href="core_test.html">
                core_test.go
              </a>
            
              
              <a class="source" href="core_tree.html">
                core_tree.go
              </a>
            
              
              <a class="source" href="refine_linearrefinegt.html">
                refine_linearrefinegt.go
              </a>
            
              
              <a class="source" href="refine_misc.html">
                refine_misc.go
              </a>
            
              
              <a class="source" href="refine_test.html">
                refine_test.go
              </a>
            
              
              <a class="source" href="refine_weightgt.html">
                refine_weightgt.go
              </a>
            
              
              <a class="source" href="refine_weightgt_test.html">
                refine_weightgt_test.go
              </a>
            
              
              <a class="source" href="test_misc.html">
                test_misc.go
              </a>
            
              
              <a class="source" href="util_contract.html">
                util_contract.go
              </a>
            
              
              <a class="source" href="util_prune.html">
                util_prune.go
              </a>
            
              
              <a class="source" href="util_simu.html">
                util_simu.go
              </a>
            
              
              <a class="source" href="util_test.html">
                util_test.go
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>refine_test.go</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">package</span> tree

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"testing"</span>
)

<span class="hljs-keyword">func</span> Test_Lineartimegt(t *testing.T) {
	<span class="hljs-keyword">var</span> gs, ss <span class="hljs-typename">string</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>gs = “((a,b,c)A,(d,e)D)R;”
gs = “(a,a,(a,b),b,c,d,d);”
gs = “(a,b,a);”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	gs = <span class="hljs-string">"(a,a,a)"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>gs = “(a,a,b,b,c,d,d)”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ss = <span class="hljs-string">"((a,b)A,(c,(d,e)D)C)R;"</span>

	gs = <span class="hljs-string">"((1,4),2,2,1,1)"</span>
	ss = <span class="hljs-string">"(((0,1),2),(3,4))"</span>

	gs = <span class="hljs-string">"(0,0,4,2,1,2)"</span>
	ss = <span class="hljs-string">"((0,1)A,((2,3)B,4)C)R"</span>

	gs = <span class="hljs-string">"((0,2,2),(1,0),3)"</span>
	ss = <span class="hljs-string">"(0,((1,2)A,(3,4)B)C)R"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>gs = “((1,1,3),(4,4,1))”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	gs = <span class="hljs-string">"(1,1,3)r"</span>
	ss = <span class="hljs-string">"((((0,1)A,2)B,3)C,4)R"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>gs = “(0,2,2)”
ss = “(0, 2)”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	gs = <span class="hljs-string">"((1,2),(3,1),3,1,3)"</span>
	ss = <span class="hljs-string">"((0,((1,2)A,3)B)C,4)R;"</span>

	gt, err := Make(gs)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		t.Log(err)
	}
	st, err := Make(ss)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		t.Log(err)
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>st.PruneFromTree(gt)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	sst, err := st.SpeciesTree()
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		t.Fatal(err)
	}
	fmt.Println(sst.IsBinary())
	fmt.Println(gt)
	fmt.Println(sst)
	err = RefineGt(gt, sst, <span class="hljs-string">"mutation"</span>,<span class="hljs-number"> 3</span>,<span class="hljs-number"> 1</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		t.Fatal(err)
	}
	fmt.Println(gt)
	fmt.Println(BinaryCost(gt, sst))
}

<span class="hljs-keyword">func</span> Test_Mutation1(t *testing.T) {
	gs := <span class="hljs-string">"(1,1,7,7,8,8)"</span>
	ss := <span class="hljs-string">"(((((((1,2),3),4),5),6),7),8);"</span>

	gt, _ := Make(gs)
	st, _ := Make(ss)
	sst, err := st.SpeciesTree()
	checkerror(t, err)

	RefineGt(gt, sst, <span class="hljs-string">"mutation"</span>)
	fmt.Println(gt)
	fmt.Println(BinaryCost(gt, sst))
	gt1, _ := Make(gs)
	RefineGt(gt1, sst, <span class="hljs-string">"weighted"</span>,<span class="hljs-number"> 3</span>,<span class="hljs-number"> 1</span>)
	fmt.Println(gt1)
	fmt.Println(BinaryCost(gt1, sst))
}

<span class="hljs-keyword">func</span> Test_Weight(t *testing.T) {
	niter :=<span class="hljs-number"> 1000</span>
	crate :=<span class="hljs-number"> 0.8</span>
	ntaxon :=<span class="hljs-number"> 40</span>
	nleaves :=<span class="hljs-number"> 80</span>

	testone := <span class="hljs-keyword">func</span>() {
		gt := SimuTreeRandomTaxon(nleaves, ntaxon)
		gt.RandomContract(crate)</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>st := SimuTree(ntaxon)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		st := LineTree2(ntaxon)
		gs := gt.String()
		ss := st.String()</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>fmt.Println(“:”)
fmt.Println(gs)
fmt.Println(ss)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		gt1, err := Make(gs)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		st1, err := Make(ss)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		sst1, err := st1.SpeciesTree()
		checkerror(t, err)
		RefineGt(gt1, sst1, <span class="hljs-string">"mutation"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>fmt.Println(gt1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		d1, l1, dc1, err := BinaryCost(gt1, sst1)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}

		gt2, err := Make(gs)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		st2, err := Make(ss)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		sst2, err := st2.SpeciesTree()
		checkerror(t, err)</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>RefineGt(gt2, sst2, 3, 2001, 1000)
RefineGt(gt2, sst2, 3, 3000, 1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		RefineGt(gt2, sst2, <span class="hljs-string">"weighted"</span>,<span class="hljs-number"> 3</span>,<span class="hljs-number"> 1</span>)
		d2, l2, dc2, err := BinaryCost(gt2, sst2)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}

		<span class="hljs-keyword">if</span> d1+l1 != d2+l2 {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>if d1 != d2 || l1 != l2 {</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fmt.Println(gs)
			fmt.Println(ss)
			fmt.Println(gt1)
			fmt.Println(gt2)
			fmt.Println(d1, l1, dc1)
			fmt.Println(d2, l2, dc2)
			t.Fatal(<span class="hljs-string">"Not equal, fail!"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>panic(“Fail!!!”)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		}
	}

	<span class="hljs-keyword">for</span> i :=<span class="hljs-number"> 0</span>; i &lt; niter<span class="hljs-number">/100</span>; i++ {
		<span class="hljs-built_in">print</span>(<span class="hljs-string">"~"</span>)
		<span class="hljs-keyword">for</span> j :=<span class="hljs-number"> 0</span>; j &lt;<span class="hljs-number"> 100</span>; j++ {
			testone()
		}
	}
	<span class="hljs-built_in">println</span>()
}

<span class="hljs-keyword">func</span> test_Integer(t *testing.T) {
	niter :=<span class="hljs-number"> 1000</span>
	crate :=<span class="hljs-number"> 0.8</span>
	ntaxon :=<span class="hljs-number"> 50</span>
	nleaves :=<span class="hljs-number"> 100</span>

	testone := <span class="hljs-keyword">func</span>() {
		gt := SimuTreeRandomTaxon(nleaves, ntaxon)
		gt.RandomContract(crate)
		st := SimuTree(ntaxon)
		gs := gt.String()
		ss := st.String()</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>fmt.Println(“:”)
fmt.Println(gs)
fmt.Println(ss)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		gt1, err := Make(gs)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		st1, err := Make(ss)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		sst1, err := st1.SpeciesTree()
		checkerror(t, err)
		RefineGt(gt1, sst1, <span class="hljs-string">"weighted"</span>,<span class="hljs-number"> 5</span>,<span class="hljs-number"> 1</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>fmt.Println(gt1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		d1, l1, dc1, err := BinaryCost(gt1, sst1)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}

		gt2, err := Make(gs)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		st2, err := Make(ss)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		sst2, err := st2.SpeciesTree()
		checkerror(t, err)</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>RefineGt(gt2, sst2, 3, 2001, 1000)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		RefineGt(gt2, sst2, <span class="hljs-string">"weighted"</span>,<span class="hljs-number"> 4</span>,<span class="hljs-number"> 1</span>)
		d2, l2, dc2, err := BinaryCost(gt2, sst2)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}

		gt3, err := Make(gs)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		st3, err := Make(ss)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}
		sst3, err := st3.SpeciesTree()
		checkerror(t, err)</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>RefineGt(gt2, sst2, 3, 2001, 1000)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		RefineGt(gt3, sst3, <span class="hljs-string">"weighted"</span>,<span class="hljs-number"> 4.1</span>,<span class="hljs-number"> 1</span>)
		d3, l3, dc3, err := BinaryCost(gt3, sst3)
		<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
			t.Log(err)
		}

		f := <span class="hljs-keyword">func</span>(a, b <span class="hljs-typename">int</span>) <span class="hljs-typename">float64</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-typename">float64</span>(a)<span class="hljs-number">*2.1</span> + <span class="hljs-typename">float64</span>(b)
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>if d1+l1 != d2+l2 {
if d1 != d2 || l1 != l2 {</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> f(d1, l1) != f(d3, l3) &amp;&amp; f(d2, l2) != f(d3, l3) {
			fmt.Println(gs)
			fmt.Println(ss)
			fmt.Println(gt1)
			fmt.Println(gt2)
			fmt.Println(gt3)
			fmt.Println(d1, l1, dc1)
			fmt.Println(d2, l2, dc2)
			fmt.Println(d3, l3, dc3)</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>t.Log(“Not equal, fail!”)
panic(“Fail!!!”)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			t.Fatal(<span class="hljs-string">"Not equal, fail!"</span>)
		}
	}

	<span class="hljs-keyword">for</span> i :=<span class="hljs-number"> 0</span>; i &lt; niter; i++ {</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>print(“~”)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		testone()
	}
	<span class="hljs-built_in">println</span>()
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
